<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Napster's Experiments with Freedom</title>
  <meta name="viewport" content="width=device-width">

  <!-- syntax highlighting CSS -->
  <link rel="stylesheet" href="/css/syntax.css">

  <!-- CSS -->
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/main.css">
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

  <!-- Fonts -->
  <link href='http://fonts.googleapis.com/css?family=Bitter:400,700,400italic|Open+Sans:400italic,600italic,400,600' rel='stylesheet' type='text/css'>
</head>
<body>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How to hack an email gatway?</title>
  <meta name="description" content="Reading time : Less than 20 minutesFor those who reads this article just to hack and spoof a mail to irritate other people, can leave right now. I don’t beli...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="canonical" href="/2011/09/05/how-to-hack-an-email-gatway.html">
  <link rel="alternate" type="application/rss+xml" title="Napster's Experiments with Freedom" href="/feed.xml" />
  
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.2.0/katex.min.css">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.2.0/katex.min.js"></script>
  
  <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  
</head>

<header style="background-image: url();">
  <div class="container post-container">
    <a href="/" class="home_button"></a>
    <div class="inner-container">
      <h1>How to hack an email gatway?</h1>
      <ul class="meta">
        <li>
          <span>
            Published
          </span>
          05 Sep 2011
        </li>
        <li>
          <span>
            Category
          </span>
          
        </li>
      </ul>      
    </div>
    <ul class="pagination">
      
        <li class="previous">
          <a href="/2011/01/20/opencv-gtk-and-a-day.html">
            Previous
          </a>
        </li>
      
      
      <li class="next">
        <a href="/2011/09/12/circular-linked-list-in-java.html">
          Next
        </a>
      </li>
      
    </ul>
  </div>
</header>

<article>
  <div class="container">
    <p>Reading time : Less than 20 minutes
For those who reads this article just to hack and spoof a mail to irritate other people, can leave right now. I don’t believe you can do it effectively before knowing what you are about to do! And also, it might possibly be illegal if other people are involved. SMTP servers are used to send mails across the Internet. They are also known as mail servers. The job of a mail server is nothing but to store and send emails as well as receive emails from other mail servers. It is possible to send emails from one user who belongs to a mail server to a user belongs to a different mail server.
So, lets find a mail server somewhere on the Internet. Before going into details, there is one more thing to mention about - ports. Ports are logical entities through which hosts and servers communicate. There are 65355 ports each for TCP and UDP. So, one could possibly say a port runs an application interface. Since many applications keep using the same ports for years, those port they use are known for running the particular application. For example, port 80 is very popular which normally runs HTTP. It doesn’t mean that HTTP can’t run on 45627 or another application can’t run on 80 either.
SMTP is a simple protocol or standard which can handle electronic mail over the Internet. You can find more details about SMTP here. SMTP runs on port number 25. So, our target is some machine which has port 25 open. There is a very useful tool named nmap. Nmap is nothing but a stealth  capable scanner which can fingerprint machines and services running on  them. You can a copy of nmap from here. I suggest you to use the command line version, since it is more flexible in my experience. And also it is good practice to use command line tools. This is because, when you break into others machines, they are never gonna provide you a very good user friendly GUI to mess their system up. Its worth noting that, running nmap on other’s machines without permission is illegal.
Finding other machines over the Internet is not a big deal. When you get an IP you can use nmap for checking if SMTP port is open or not. Use the following command for doing this. Since some hosts/firewalls blocks ping probs, we can use SYN scan.</p>

<p>nmap -sS -P0 target_ip</p>

<p>A typical output from the above command is shown in the below screenshot. Even if there are more open ports, we are particularly interested in the SMTP port.</p>

<p>Now, we have a mail gatway. If nmap result does not have port 25 open on a particular IP, obviously you are not lucky! :) Now, lets hack this mail gateway. I should not use the word “hack” actually, since all SMTP mail gateways has this functionality. If the owners of the machines keep it secure, then no one can misuse it. But as usual, no one cares!
So what we are going to do is, connect to the mail gateway and issue a set of commands which is recognized all mail gateways, to send an email using the gateway. So lets connect to the gateway first.</p>

<p>telnet target_ip 25</p>

<p>See there is a space between the target_ip and the port in the command. In some cases the host may refuse to connect. I’m not sure if you can use any other tools to connect then. If you know any other methods that can be used in that situation, just update me too! On successful connection, the mail gateway will show you a server banner or a welcome message. I’ll show you a set of commands that are recognized by the mail gateway.
HELO/EHLO - used to introduce you to the mail server
MAIL FROM - used to set the originating email address
RCPT TO - used to set the target email address
DATA - used to input the message body
Apart from this, there are a couple of commands which is used for various purposes. But, to send an email, the above commands are enough. Now, lets see the below screenshot which shows how to use the mail gateway for sending an email from one address to other.</p>

<p>As you can see, I was able to get in to the gateway and send an email from napster@hacker.com to hacker@napster.com. Though either of the email ids doesn’t exist, I was still able to relay the mail. If the receiver mail does exists, an email will reach its inbox even though the sending email id doesn’t exist at all. You might have understood the impact it can cause. If it possible to send an email from one guy to other without their permission is cool, huh? But, think again, you might get prosecuted if you really do so. So, be careful!
//I’ll be updating this thread with the mitigation as soon as possible//See you in the afterlife ;)//Subin Sebastian</p>

	<div id="disqus_thread"></div>	
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES * * */
// Required: on line below, replace text in quotes with your forum shortname
var disqus_shortname = 'subinsebastien';
    
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</article>

</body>
</html>
